<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="en">
<head>
    <meta charset="UTF-8">
    <title>Админка</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body class="bg-dark text-light">
    <div th:replace="~{fragments/navbar}"></div>

    <div class="container mt-5 mb-5">
        <h2><i class="bi bi-table"></i> Таблица пользователей</h2>

        <div class="card shadow">
            <table class="table">
                <thead>
                <th>Имя</th>
                <th>Телефон</th>
                <th>Почта</th>
                <th>Роль</th>
                </thead>
                <tbody>
                <tr th:each="user : ${users}">
                    <td th:text="${user.username}"></td>
                    <td th:text="${user.phone}"></td>
                    <td th:text="${user.email}"></td>
                    <td>
                                    <span th:if="${user.role == T(com.railway.RailwayStation3.repository.User).ROLE_ADMIN}"
                                          class="badge bg-primary">
                                        Администратор
                                    </span>
                        <span th:if="${user.role == T(com.railway.RailwayStation3.repository.User).ROLE_USER}"
                              class="badge bg-secondary">
                                        Пользователь
                                    </span>
                    </td>
                    <td>
                        <form th:action="@{/admin/update-role}" method="post" class="row g-2">
                            <input type="hidden" name="userId" th:value="${user.id}">
                            <div class="col-md-8">
                                <select name="newRole" class="form-select form-select-sm">
                                    <option th:value="${T(com.railway.RailwayStation3.repository.User).ROLE_ADMIN}"
                                            th:selected="${user.role == T(com.railway.RailwayStation3.repository.User).ROLE_ADMIN}">
                                        Администратор
                                    </option>
                                    <option th:value="${T(com.railway.RailwayStation3.repository.User).ROLE_USER}"
                                            th:selected="${user.role == T(com.railway.RailwayStation3.repository.User).ROLE_USER}">
                                        Пользователь
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <button type="submit" class="btn btn-sm btn-success w-100">
                                    <i class="bi bi-check-lg"></i> Применить
                                </button>
                            </div>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>